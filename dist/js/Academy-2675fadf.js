import{r as e,z as s,o as a,C as l,c,e as o,f as n,t as r,n as t,h as i,F as u,y as d,j as g,x as p,l as v}from"./vendor-aa0ffa31.js";import{_ as y,b as f,u as h,n as m}from"./index-c9e88ec7.js";const k={class:"academy-page"},C={class:"academy-hero section-padding"},b={class:"container"},_={class:"hero-content animate__animated animate__fadeInDown"},w={class:"hero-title"},S={class:"hero-subtitle"},P={class:"courses-section section-padding"},A={class:"container"},M={class:"section-header"},T={class:"section-title"},x={class:"section-subtitle"},I={key:0,class:"category-filter"},$=["onClick"],D={key:1,class:"loading-state"},j={key:2,class:"error-state"},L={key:3,class:"courses-grid"},F={class:"course-badges"},z={key:0,class:"purchased-badge"},E=["onClick"],q={key:1,class:"course-price"},B={class:"price-amount"},G={class:"course-info"},H={key:0,class:"course-category"},J={class:"course-title"},K={class:"course-description"},N={class:"course-meta"},O={key:0,class:"meta-item"},Q={class:"course-action"},R=["onClick"],U=["onClick","disabled"],V={key:0,class:"fas fa-spinner fa-spin"},W={key:1,class:"fas fa-shopping-cart"},X={key:4,class:"empty-state"},Y={class:"modal-header"},Z={key:0,class:"modal-body"},ee={class:"purchase-summary"},se={class:"course-preview"},ae={class:"preview-info"},le={class:"purchase-details"},ce={class:"detail-row"},oe={class:"price"},ne={class:"detail-row"},re={class:"tokens"},te={class:"detail-row total"},ie={class:"remaining"},ue={class:"modal-footer"},de=["disabled"],ge={key:0,class:"fas fa-spinner fa-spin"},pe={key:1};const ve=y({name:"Academy",setup(){const c=f(),o=h(),n=e(!1),r=e(null),t=e(!1),i=e([]),u=e([]),d=e([]),g=e(null),p=e(!1),v=e(null),y=s(()=>g.value?i.value.filter(e=>e.is_active&&e.category_id===g.value):i.value.filter(e=>e.is_active)),k=s(()=>{var e;return(null==(e=c.user)?void 0:e.tokens)||0}),C=async()=>{n.value=!0,r.value=null;try{const[e,s]=await Promise.all([m.getAcademyCourses(),m.getAcademyCategories()]);e.success&&(i.value=e.courses||[]),s.success&&(u.value=s.categories||[]),c.isLoggedIn&&await b()}catch(e){r.value="Грешка при зареждане на курсовете"}finally{n.value=!1}},b=async()=>{try{const e=await m.getMyAcademyCourses();e.success&&(d.value=e.courses||[])}catch(e){}},_=e=>k.value>=e,w=()=>{p.value=!1,v.value=null};return a(()=>{C()}),l(()=>c.isLoggedIn,e=>{e?b():d.value=[]}),{languageStore:o,loading:n,error:r,purchasing:t,courses:i,categories:u,selectedCategory:g,filteredCourses:y,userTokens:k,showPurchaseModal:p,selectedCourse:v,loadCourses:C,isPurchased:e=>d.value.some(s=>s.id===e),canAfford:_,getDifficultyText:e=>({beginner:"За начинаещи",intermediate:"За напреднали",advanced:"За експерти"}[e]||e),purchaseCourse:e=>{c.isLoggedIn?_(e.price_tokens)?(v.value=e,p.value=!0):alert("Нямате достатъчно токени за този курс"):alert("Моля, влезте в профила си за да купите курс")},closePurchaseModal:w,confirmPurchase:async()=>{if(v.value){t.value=!0;try{const e=await m.purchaseAcademyCourse(v.value.id);e.success?("number"==typeof e.remaining_tokens&&await c.updateTokens(e.remaining_tokens),await b(),alert(`Успешно закупихте курса!\nПлатени токени: ${e.tokens_spent}\nОставащи токени: ${e.remaining_tokens}`),w()):alert("❌ Грешка при покупката: "+(e.error||e.message||"Неизвестна грешка"))}catch(e){e.response&&e.response.data&&e.response.data.message?alert("Грешка при покупката: "+e.response.data.message):alert("Грешка при покупката. Моля, опитайте отново.")}finally{t.value=!1}}},watchCourse:e=>{e.youtube_url?window.open(e.youtube_url,"_blank"):alert("Видеото не е налично в момента")}}}},[["render",function(e,s,a,l,y,f){return c(),o("div",k,[n("section",C,[s[9]||(s[9]=n("div",{class:"hero-bg-pattern"},null,-1)),s[10]||(s[10]=n("div",{class:"hero-particles"},null,-1)),n("div",b,[n("div",_,[s[7]||(s[7]=n("div",{class:"hero-icon-wrapper"},[n("div",{class:"icon-glow"}),n("i",{class:"fas fa-graduation-cap hero-main-icon"})],-1)),n("h1",w,r(l.languageStore.t("racingAcademy")),1),n("p",S,r(l.languageStore.t("learnToDrive")),1),s[8]||(s[8]=n("div",{class:"hero-decorative-line"},[n("span",{class:"line-segment"}),n("span",{class:"line-diamond"},"◆"),n("span",{class:"line-segment"})],-1))])])]),n("section",P,[n("div",A,[n("div",M,[n("h2",T,r(l.languageStore.t("academyCourses")),1),n("p",x,r(l.languageStore.t("chooseCourse")),1)]),l.categories.length>0?(c(),o("div",I,[n("button",{onClick:s[0]||(s[0]=e=>l.selectedCategory=null),class:t(["category-btn",{active:null===l.selectedCategory}])},[s[11]||(s[11]=n("i",{class:"fas fa-th-large"},null,-1)),i(" "+r(l.languageStore.t("allCourses")),1)],2),(c(!0),o(u,null,d(l.categories,e=>(c(),o("button",{key:e.id,onClick:s=>l.selectedCategory=e.id,class:t(["category-btn",{active:l.selectedCategory===e.id}])},[n("i",{class:t(e.icon)},null,2),i(" "+r(e.name),1)],10,$))),128))])):g("",!0),l.loading?(c(),o("div",D,[s[12]||(s[12]=n("i",{class:"fas fa-spinner fa-spin"},null,-1)),n("span",null,r(l.languageStore.t("loadingCourses")),1)])):l.error?(c(),o("div",j,[s[13]||(s[13]=n("i",{class:"fas fa-exclamation-triangle"},null,-1)),n("span",null,r(l.error),1),n("button",{onClick:s[1]||(s[1]=(...e)=>l.loadCourses&&l.loadCourses(...e)),class:"btn-secondary"},r(l.languageStore.t("tryAgain")),1)])):(c(),o("div",L,[(c(!0),o(u,null,d(l.filteredCourses,e=>(c(),o("div",{key:e.id,class:t(["course-card",{purchased:l.isPurchased(e.id)}])},[n("div",{class:"course-thumbnail",style:p(e.thumbnail_url?`background-image: url('${e.thumbnail_url}')`:"")},[s[17]||(s[17]=n("div",{class:"course-overlay"},null,-1)),n("div",F,[n("span",{class:t(["difficulty-badge",`difficulty-${e.difficulty}`])},r(l.getDifficultyText(e.difficulty)),3),l.isPurchased(e.id)?(c(),o("span",z,[s[14]||(s[14]=n("i",{class:"fas fa-check"},null,-1)),i(" "+r(l.languageStore.t("purchased")),1)])):g("",!0)]),l.isPurchased(e.id)?(c(),o("div",{key:0,class:"play-button",onClick:s=>l.watchCourse(e)},s[15]||(s[15]=[n("i",{class:"fas fa-play"},null,-1)]),8,E)):(c(),o("div",q,[n("span",B,r(e.price_tokens),1),s[16]||(s[16]=n("i",{class:"fas fa-coins"},null,-1))]))],4),n("div",G,[e.category_name?(c(),o("div",H,[n("i",{class:t(e.category_icon||"fas fa-graduation-cap")},null,2),i(" "+r(e.category_name),1)])):g("",!0),n("h3",J,r(e.title),1),n("p",K,r(e.description),1),n("div",N,[e.duration?(c(),o("div",O,[s[18]||(s[18]=n("i",{class:"fas fa-clock"},null,-1)),i(" "+r(e.duration),1)])):g("",!0)]),n("div",Q,[l.isPurchased(e.id)?(c(),o("button",{key:0,onClick:s=>l.watchCourse(e),class:"btn-primary"},[s[19]||(s[19]=n("i",{class:"fas fa-play"},null,-1)),i(" "+r(l.languageStore.t("watchCourse")),1)],8,R)):(c(),o("button",{key:1,onClick:s=>l.purchaseCourse(e),class:"btn-secondary",disabled:!l.canAfford(e.price_tokens)||l.purchasing},[l.purchasing?(c(),o("i",V)):(c(),o("i",W)),i(" "+r(l.canAfford(e.price_tokens)?l.languageStore.t("buyFor")+" "+e.price_tokens+" "+l.languageStore.t("tokens"):l.languageStore.t("notEnoughTokens")),1)],8,U))])])],2))),128))])),l.loading||l.error||0!==l.filteredCourses.length?g("",!0):(c(),o("div",X,[s[20]||(s[20]=n("i",{class:"fas fa-graduation-cap"},null,-1)),n("h3",null,r(l.languageStore.t("noCoursesAvailable")),1),n("p",null,r(l.languageStore.t("addCoursesSoon")),1)]))])]),l.showPurchaseModal?(c(),o("div",{key:0,class:"modal-overlay",onClick:s[6]||(s[6]=(...e)=>l.closePurchaseModal&&l.closePurchaseModal(...e))},[n("div",{class:"modal-content",onClick:s[5]||(s[5]=v(()=>{},["stop"]))},[n("div",Y,[n("h3",null,r(l.languageStore.t("confirmPurchase")),1),n("button",{onClick:s[2]||(s[2]=(...e)=>l.closePurchaseModal&&l.closePurchaseModal(...e)),class:"modal-close"},s[21]||(s[21]=[n("i",{class:"fas fa-times"},null,-1)]))]),l.selectedCourse?(c(),o("div",Z,[n("div",ee,[n("div",se,[n("div",{class:"preview-thumbnail",style:p(l.selectedCourse.thumbnail_url?`background-image: url('${l.selectedCourse.thumbnail_url}')`:"")},s[22]||(s[22]=[n("div",{class:"preview-overlay"},null,-1)]),4),n("div",ae,[n("h4",null,r(l.selectedCourse.title),1),n("p",null,r(l.selectedCourse.description),1)])]),n("div",le,[n("div",ce,[n("span",null,r(l.languageStore.t("price"))+":",1),n("span",oe,r(l.selectedCourse.price_tokens)+" "+r(l.languageStore.t("tokens")),1)]),n("div",ne,[n("span",null,r(l.languageStore.t("yourTokens"))+":",1),n("span",re,r(l.userTokens)+" "+r(l.languageStore.t("tokens")),1)]),n("div",te,[n("span",null,r(l.languageStore.t("remaining"))+":",1),n("span",ie,r(l.userTokens-l.selectedCourse.price_tokens)+" "+r(l.languageStore.t("tokens")),1)])])])])):g("",!0),n("div",ue,[n("button",{onClick:s[3]||(s[3]=(...e)=>l.closePurchaseModal&&l.closePurchaseModal(...e)),class:"btn-secondary"}," Отказ "),n("button",{onClick:s[4]||(s[4]=(...e)=>l.confirmPurchase&&l.confirmPurchase(...e)),class:"btn-primary",disabled:l.purchasing},[l.purchasing?(c(),o("i",ge)):(c(),o("span",pe,"Купи курса"))],8,de)])])])):g("",!0)])}],["__scopeId","data-v-7afad78e"]]);export{ve as default};
