import{r as e,o as a,c as s,e as t,f as i,t as n,h as r,F as c,y as l,j as o,k as d,g as p,w as u,T as m,n as g,x as v}from"./vendor-aa0ffa31.js";import{_ as f,b as y,u as _,n as h}from"./index-c9e88ec7.js";const b={class:"tournaments-page"},k={class:"tournaments-header section-padding page-header-with-nav"},S={class:"container"},T={class:"header-content animate__animated animate__fadeInDown"},w={class:"page-title"},x={class:"page-subtitle"},R={class:"tournaments-content section-padding"},z={class:"container"},J={key:0,class:"loading-state"},U={key:1,class:"error-state"},j={key:2},M={key:0,class:"tournaments-section"},D={class:"section-header"},C={class:"section-title"},A={class:"live-badge"},G={class:"tournaments-grid"},I={class:"tournament-status"},P={class:"status-badge active"},N={class:"prize-amount"},$={class:"tournament-badges"},B={class:"badge game-type"},E={class:"card-content"},F={class:"tournament-name"},L={class:"tournament-description"},W={class:"tournament-info"},q={class:"info-item"},H={class:"info-label"},K={class:"info-value"},O={class:"info-item"},Q={class:"info-label"},V={class:"info-value"},X={class:"info-item"},Y={class:"info-label"},Z={class:"info-value"},ee={class:"progress-section"},ae={class:"progress-bar"},se={class:"progress-text"},te={class:"card-footer"},ie=["onClick","disabled"],ne={key:0,class:"fas fa-spinner fa-spin"},re={key:1,class:"fas fa-check"},ce={key:2,class:"fas fa-lock"},le={key:3,class:"fas fa-bolt"},oe={key:4},de={key:5},pe={key:6},ue={key:7},me={key:1,class:"tournaments-section"},ge={class:"section-header"},ve={class:"section-title"},fe={class:"upcoming-list"},ye={class:"upcoming-info"},_e={class:"upcoming-name"},he={class:"upcoming-description"},be={class:"upcoming-details"},ke={class:"upcoming-date"},Se={class:"upcoming-prize"},Te={class:"upcoming-action"},we={class:"register-btn"},xe={key:2,class:"tournaments-section"},Re={class:"section-header"},ze={class:"section-title"},Je={class:"completed-table"},Ue={class:"table-body"},je={class:"table-cell tournament-cell"},Me={class:"table-cell winner-cell"},De={class:"table-cell prize-cell"},Ce={class:"table-cell date-cell"},Ae={key:0,class:"notification"};const Ge=f({name:"Tournaments",setup(){const s=e(!1),t=e(!0),i=e(null),n=y(),r=_(),c=e({active:[],upcoming:[],completed:[]}),l=async()=>{t.value=!0,i.value=null;try{const a=await h.getTournaments();if(!a.success)throw new Error("API response not successful");{const s=a.tournaments||{};let t=[];t=Array.isArray(s)?s:[...s.active||[],...s.upcoming||[],...s.completed||[]];let i=[];try{const e=await h.getMyTournamentRegistrations();e.success&&(i=e.registrations||[])}catch(e){}s.active&&s.upcoming&&s.completed?(c.value.active=s.active.map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1})),c.value.upcoming=s.upcoming.map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1})),c.value.completed=s.completed.map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1}))):(c.value.active=t.filter(e=>"active"===e.status).map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1})),c.value.upcoming=t.filter(e=>"upcoming"===e.status).map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1})),c.value.completed=t.filter(e=>"completed"===e.status).map(e=>({...e,isUserRegistered:i.some(a=>a.tournament_id===e.id),isJoining:!1})))}}catch(a){c.value={active:[{id:1,name:"Monza Speed Challenge",description:"Кой е най-бързият на легендарната италианска писта? Докажете скоростта си в този интензивен турнир!",prize:500,current_participants:8,max_participants:16,date:"20 Януари 2024",status:"active",isUserRegistered:!1,isJoining:!1},{id:2,name:"Nürburgring Masters",description:'Покорете "Зеленият ад" - най-предизвикателната писта в света на автомобилните спортове!',prize:750,current_participants:12,max_participants:20,date:"22 Януари 2024",status:"active",isUserRegistered:!1,isJoining:!1},{id:3,name:"Monaco Street Circuit",description:"Най-престижният градски турнир! Навигирайте през тесните улици на Монако като истински професионалист.",prize:1e3,current_participants:15,max_participants:24,date:"25 Януари 2024",status:"active",isUserRegistered:!1,isJoining:!1}],upcoming:[{id:4,name:"Spa Championship",description:"Класическият белгийски кръг",prize:1e3,date:"25 Януари 2024",status:"upcoming"},{id:5,name:"Monaco Grand Prix",description:"Най-престижната писта във формула 1",prize:1500,date:"28 Януари 2024",status:"upcoming"},{id:6,name:"Le Mans Endurance",description:"24-часово състезание на издръжливост",prize:2e3,date:"1 Февруари 2024",status:"upcoming"}],completed:[{id:7,name:"Silverstone Sprint",winner:"SpeedDemon",prize:400,date:"15 Януари 2024",status:"completed"},{id:8,name:"Imola Challenge",winner:"RacingPro",prize:600,date:"10 Януари 2024",status:"completed"},{id:9,name:"Suzuka Masters",winner:"TurboRacer",prize:800,date:"5 Януари 2024",status:"completed"}]}}finally{t.value=!1}};return a(()=>{l()}),{languageStore:r,tournaments:c,showNotification:s,loading:t,error:i,joinTournament:async e=>{if(e.isUserRegistered)alert("Вече сте записани в този турнир!");else if((e.current_participants||0)>=e.max_participants)alert("Турнирът е пълен!");else{e.isJoining=!0;try{const a=await h.joinTournament(e.id);a.success?(e.current_participants=(e.current_participants||0)+1,e.isUserRegistered=!0,"number"==typeof a.remaining_tokens&&await n.updateTokens(a.remaining_tokens),s.value=!0,setTimeout(()=>{s.value=!1},3e3),alert(`Успешно се записахте в турнира!\nПлатени токени: ${a.tokens_paid}\nОставащи токени: ${a.remaining_tokens}`)):alert("Грешка при записването: "+(a.error||a.message||"Неизвестна грешка"))}catch(a){a.response&&a.response.data&&a.response.data.message?alert("Грешка при записването: "+a.response.data.message):alert("Грешка при записването. Моля, опитайте отново.")}finally{e.isJoining=!1}}},loadTournaments:l,formatDate:e=>new Date(e).toLocaleDateString("bg-BG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),getGameTypeText:e=>({racing:"Състезание",time_trial:"Time Trial",drift:"Дрифт",endurance:"Издръжливост"}[e]||"Състезание"),getDifficultyText:e=>({beginner:"За начинаещи",medium:"Средно ниво",expert:"За експерти",pro:"Професионално"}[e]||"Средно ниво")}}},[["render",function(e,a,f,y,_,h){return s(),t("div",b,[i("div",k,[a[3]||(a[3]=i("div",{class:"header-bg-pattern"},null,-1)),a[4]||(a[4]=i("div",{class:"header-particles"},null,-1)),i("div",S,[i("div",T,[a[1]||(a[1]=i("div",{class:"header-icon-wrapper"},[i("div",{class:"icon-glow"}),i("i",{class:"fas fa-trophy header-main-icon"})],-1)),i("h1",w,n(y.languageStore.t("tournamentsTitle")),1),i("p",x,n(y.languageStore.t("competeWithBest")),1),a[2]||(a[2]=i("div",{class:"header-decorative-line"},[i("span",{class:"line-segment"}),i("span",{class:"line-diamond"},"◆"),i("span",{class:"line-segment"})],-1))])])]),i("div",R,[i("div",z,[y.loading?(s(),t("div",J,[a[5]||(a[5]=i("div",{class:"loading-spinner"},[i("i",{class:"fas fa-spinner fa-spin"})],-1)),i("p",null,n(y.languageStore.t("loadingTournaments")),1)])):y.error?(s(),t("div",U,[a[7]||(a[7]=i("div",{class:"error-icon"},[i("i",{class:"fas fa-exclamation-triangle"})],-1)),i("p",null,n(y.error),1),i("button",{onClick:a[0]||(a[0]=(...e)=>y.loadTournaments&&y.loadTournaments(...e)),class:"retry-btn"},[a[6]||(a[6]=i("i",{class:"fas fa-sync-alt"},null,-1)),r(" "+n(y.languageStore.t("tryAgain")),1)])])):(s(),t("div",j,[y.tournaments.active.length>0?(s(),t("section",M,[i("div",D,[i("h2",C,[a[8]||(a[8]=i("i",{class:"fas fa-fire section-icon"},null,-1)),r(" "+n(y.languageStore.t("activeTournaments"))+" ",1),i("span",A,n(y.languageStore.t("live")),1)])]),i("div",G,[(s(!0),t(c,null,l(y.tournaments.active,e=>(s(),t("div",{key:e.id,class:g(["tournament-card",{featured:e.featured}])},[i("div",{class:"tournament-image",style:v(e.image_url?`background-image: url('${e.image_url}')`:"")},[a[10]||(a[10]=i("div",{class:"image-overlay"},null,-1)),i("div",I,[i("span",P,n(y.languageStore.t("active")),1),i("div",N,n(e.prize)+" "+n(y.languageStore.t("tokens")),1)]),i("div",$,[i("span",B,[i("i",{class:g(["fas",{"fa-flag-checkered":"racing"===e.game_type,"fa-stopwatch":"time_trial"===e.game_type,"fa-car-side":"drift"===e.game_type,"fa-road":"endurance"===e.game_type}])},null,2),r(" "+n(y.getGameTypeText(e.game_type)),1)]),i("span",{class:g(["badge difficulty",e.difficulty])},[a[9]||(a[9]=i("i",{class:"fas fa-star"},null,-1)),r(" "+n(y.getDifficultyText(e.difficulty)),1)],2)])],4),i("div",E,[i("h3",F,n(e.name),1),i("p",L,n(e.description),1),i("div",W,[i("div",q,[i("span",H,n(y.languageStore.t("participants"))+":",1),i("span",K,n(e.current_participants||0)+"/"+n(e.max_participants),1)]),i("div",O,[i("span",Q,n(y.languageStore.t("entryFee"))+":",1),i("span",V,n(e.entry_fee||0)+" "+n(y.languageStore.t("tokens")),1)]),i("div",X,[i("span",Y,n(y.languageStore.t("date"))+":",1),i("span",Z,n(y.formatDate(e.date)),1)])]),i("div",ee,[i("div",ae,[i("div",{class:"progress-fill",style:v({width:(e.current_participants||0)/e.max_participants*100+"%"})},null,4)]),i("span",se,n(Math.round((e.current_participants||0)/e.max_participants*100))+"% "+n(y.languageStore.t("filled")),1)])]),i("div",te,[i("button",{onClick:a=>y.joinTournament(e),class:g(["join-btn",{registered:e.isUserRegistered,full:e.participants>=e.maxParticipants,loading:e.isJoining}]),disabled:e.isUserRegistered||(e.current_participants||0)>=e.max_participants||e.isJoining},[e.isJoining?(s(),t("i",ne)):e.isUserRegistered?(s(),t("i",re)):e.participants>=e.max_participants?(s(),t("i",ce)):(s(),t("i",le)),e.isJoining?(s(),t("span",oe,n(y.languageStore.t("joining")),1)):e.isUserRegistered?(s(),t("span",de,n(y.languageStore.t("registered")),1)):(e.current_participants||0)>=e.max_participants?(s(),t("span",pe,n(y.languageStore.t("full")),1)):(s(),t("span",ue,n(y.languageStore.t("joinTournament")),1))],10,ie)])],2))),128))])])):o("",!0),y.tournaments.upcoming.length>0?(s(),t("section",me,[i("div",ge,[i("h2",ve,[a[11]||(a[11]=i("i",{class:"fas fa-calendar-alt section-icon"},null,-1)),r(" "+n(y.languageStore.t("upcomingTournaments")),1)])]),i("div",fe,[(s(!0),t(c,null,l(y.tournaments.upcoming,e=>(s(),t("div",{key:e.id,class:"upcoming-card"},[a[13]||(a[13]=i("div",{class:"upcoming-icon"},[i("i",{class:"fas fa-clock"})],-1)),i("div",ye,[i("h3",_e,n(e.name),1),i("p",he,n(e.description),1),i("div",be,[i("span",ke,n(e.date),1),i("span",Se,n(e.prize)+" "+n(y.languageStore.t("tokens")),1)])]),i("div",Te,[i("button",we,[a[12]||(a[12]=i("i",{class:"fas fa-bell"},null,-1)),r(" "+n(y.languageStore.t("remindMe")),1)])])]))),128))])])):o("",!0),y.tournaments.completed.length>0?(s(),t("section",xe,[i("div",Re,[i("h2",ze,[a[14]||(a[14]=i("i",{class:"fas fa-trophy section-icon"},null,-1)),r(" "+n(y.languageStore.t("completedTournaments")),1)])]),i("div",Je,[a[16]||(a[16]=d('<div class="table-header" data-v-57fea667><div class="header-cell" data-v-57fea667>Турнир</div><div class="header-cell" data-v-57fea667>Победител</div><div class="header-cell" data-v-57fea667>Награда</div><div class="header-cell" data-v-57fea667>Дата</div></div>',1)),i("div",Ue,[(s(!0),t(c,null,l(y.tournaments.completed,e=>(s(),t("div",{key:e.id,class:"table-row"},[i("div",je,n(e.name),1),i("div",Me,[a[15]||(a[15]=i("i",{class:"fas fa-crown"},null,-1)),r(" "+n(e.winner),1)]),i("div",De,n(e.prize)+" токена",1),i("div",Ce,n(e.date),1)]))),128))])])])):o("",!0)]))])]),p(m,{name:"notification"},{default:u(()=>[y.showNotification?(s(),t("div",Ae,a[17]||(a[17]=[i("div",{class:"notification-content"},[i("i",{class:"fas fa-check-circle"}),i("div",{class:"notification-text"},[i("div",{class:"notification-title"},"Успешно записване!"),i("div",{class:"notification-message"},"Записахте се в турнира")])],-1)]))):o("",!0)]),_:1})])}],["__scopeId","data-v-57fea667"]]);export{Ge as default};
